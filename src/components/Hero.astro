---
// ShoppingCarousel.astro
interface Slide {
  id: number;
  title: string;
  discount: string;
  description: string;
  deposit: string;
  buttonText: string;
  image: string;
  alt: string;
  badgeText: string;
  slug: string;
}

export interface Props {
  slides?: Slide[];
  heading?: string;
  subheading?: string;
}

const {
  heading = "Best Phone Deals in Kenya",
  subheading = "Shop smartphones with flexible payment plans and amazing discounts",
  slides = [
    {
      id: 1,
      title: "Samsung Galaxy A06",
      discount: "Up To 25% Off",
      description: "AMAZING DISCOUNT AND DEALS",
      deposit: "Ksh 3,500",
      buttonText: "SHOP NOW",
      image: "/phones/samsunga06black.png",
      alt: "Samsung Galaxy A06 smartphone with flexible payment plan starting from Ksh 3,500 deposit in Kenya",
      badgeText: "BIG SALE",
      slug: "/product/samsung-galaxy-a06",
    },
    {
      id: 2,
      title: "Tecno Spark 40",
      discount: "Up To 35% Off",
      description: "EXCLUSIVE DEALS TODAY",
      deposit: "Ksh 3,999",
      buttonText: "ORDER NOW",
      image: "/phones/tecnospark40.png",
      alt: "Tecno Spark 40 mobile phone on sale with up to 35% discount, deposit from Ksh 3,999 in Kenya",
      badgeText: "FLASH SALE",
      slug: "/product/tecno-spark-40",
    },
    {
      id: 3,
      title: "Samsung Galaxy A16",
      discount: "Up To 30% Off",
      description: "LIMITED TIME OFFER",
      deposit: "Ksh 6,500",
      buttonText: "BUY NOW",
      image: "/phones/samsunga16black.png",
      alt: "Samsung Galaxy A16 smartphone limited time offer, deposit starting at Ksh 6,500 with payment plan in Kenya",
      badgeText: "HOT DEAL",
      slug: "/product/samsung-galaxy-a16",
    },
  ],
} = Astro.props;
---

<link rel="preload" as="image" href={slides[0].image} />

<section
  class="hero-carousel-section"
  aria-label="Featured smartphone deals and offers"
  itemscope
  itemtype="https://schema.org/ProductCollection"
>
  <div class="visually-hidden">
    <h1 itemprop="name">{heading}</h1>
    <p itemprop="description">{subheading}</p>
  </div>

  <div
    class="card-container"
    role="region"
    aria-label="Product carousel with smartphone deals"
  >
    <div class="card-content slide-1">
      <div class="floating-elements" aria-hidden="true">
        <div class="floating-circle"></div>
        <div class="floating-circle"></div>
        <div class="floating-circle"></div>
      </div>

      <div
        class="progress-bar"
        role="progressbar"
        aria-label="Carousel progress"
        aria-valuenow="0"
        aria-valuemin="0"
        aria-valuemax="100"
      >
      </div>

      <div class="left">
        {
          slides.map((slide, index) => (
            <article
              class={`hero-content ${index === 0 ? "active" : ""}`}
              id={`hero${slide.id}`}
              aria-hidden={index !== 0}
              itemscope
              itemtype="https://schema.org/Product"
            >
              <div class="big" aria-label={`${slide.badgeText} badge`}>
                <span
                  itemprop="offers"
                  itemscope
                  itemtype="https://schema.org/Offer"
                >
                  <meta
                    itemprop="availability"
                    content="https://schema.org/InStock"
                  />
                  {slide.badgeText}
                </span>
              </div>

              <h2 class="ai" itemprop="name">
                {slide.title}
              </h2>
              <p
                class="ai discount-text"
                itemprop="offers"
                itemscope
                itemtype="https://schema.org/Offer"
              >
                <span
                  itemprop="priceSpecification"
                  itemscope
                  itemtype="https://schema.org/PriceSpecification"
                >
                  {slide.discount}
                </span>
              </p>
              <p class="description-text">{slide.description}</p>

              <div class="from">
                <h3>DEPOSIT</h3>
                <p
                  class="seesaw"
                  itemprop="offers"
                  itemscope
                  itemtype="https://schema.org/Offer"
                >
                  <span itemprop="price">{slide.deposit}</span>
                  <meta itemprop="priceCurrency" content="KES" />
                </p>
              </div>

              <a
                href={slide.slug}
                aria-label={`Shop ${slide.title} with ${slide.discount} discount, deposit from ${slide.deposit}`}
                itemprop="url"
              >
                {slide.buttonText}
              </a>
            </article>
          ))
        }
      </div>

      <aside class="right" aria-label="Product images">
        <div class="img-container">
          {
            slides.map((slide, index) => (
              <img
                src={slide.image}
                alt={slide.alt}
                id={`img${slide.id}`}
                class={index === 0 ? "active" : ""}
                loading={index === 0 ? "eager" : "lazy"}
                decoding={index === 0 ? "sync" : "async"}
                width="350"
                height="320"
                itemprop="image"
              />
            ))
          }
        </div>

        <button
          class="navigation-arrows prev-arrow"
          id="prevBtn"
          type="button"
          aria-label="View previous phone deal"
        >
          <span aria-hidden="true">‹</span>
        </button>
        <button
          class="navigation-arrows next-arrow"
          id="nextBtn"
          type="button"
          aria-label="View next phone deal"
        >
          <span aria-hidden="true">›</span>
        </button>
      </aside>

      <nav class="state-indicators" aria-label="Carousel navigation dots">
        {
          slides.map((slide, index) => (
            <button
              class={`state-dot ${index === 0 ? "active" : ""}`}
              data-slide={index}
              type="button"
              aria-label={`Go to slide ${index + 1}: ${slide.title}`}
              aria-current={index === 0 ? "true" : "false"}
            />
          ))
        }
      </nav>
    </div>
  </div>
</section>

<style>
  .visually-hidden {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0, 0, 0, 0);
    white-space: nowrap;
    border-width: 0;
  }

  .hero-carousel-section {
    position: relative;
    width: 100%;
  }

  .discount-text,
  .description-text {
    margin: 0;
  }

  :root {
    --tilt: 6deg;
    --speed: 0.9s;
    --cycle-duration: 30s;
    --primary-blue: #1f1f1f;
    --primary-green: #6c2bd9;
    --primary-red: #ff1a00;
  }

  .card-container {
    width: 100vw;
    max-width: 950px;
    height: 450px;
    position: relative;
    overflow: hidden;
    border-radius: 20px;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.2);
    margin: 0 auto;
    margin-top: 80px;
  }

  h1,
  h2,
  h3,
  p {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
      Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
    margin: 0;
  }

  .card-content {
    width: 100%;
    height: 100%;
    background: var(--primary-blue);
    display: grid;
    grid-template-columns: 1fr 1fr;
    transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
  }

  .card-content::before {
    content: "";
    position: absolute;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      45deg,
      rgba(255, 255, 255, 0.1) 0%,
      rgba(255, 255, 255, 0.05) 100%
    );
    pointer-events: none;
  }

  .card-content.slide-1,
  .card-content.slide-2,
  .card-content.slide-3 {
    background: linear-gradient(135deg, var(--primary-red) 0%, #f59e0b 100%);
  }

  .floating-elements {
    position: absolute;
    width: 100%;
    height: 100%;
    pointer-events: none;
    z-index: 1;
  }

  .floating-circle {
    position: absolute;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.1);
    animation: float 6s ease-in-out infinite;
  }

  .floating-circle:nth-child(1) {
    width: 80px;
    height: 80px;
    top: 20%;
    left: 10%;
    animation-delay: 0s;
  }

  .floating-circle:nth-child(2) {
    width: 60px;
    height: 60px;
    top: 60%;
    left: 5%;
    animation-delay: 2s;
  }

  .floating-circle:nth-child(3) {
    width: 100px;
    height: 100px;
    top: 10%;
    right: 15%;
    animation-delay: 4s;
  }

  @keyframes float {
    0%,
    100% {
      transform: translateY(0px) rotate(0deg);
      opacity: 0.3;
    }
    50% {
      transform: translateY(-20px) rotate(180deg);
      opacity: 0.6;
    }
  }

  .progress-bar {
    position: absolute;
    bottom: 0;
    left: 0;
    height: 4px;
    background: rgba(255, 255, 255, 0.3);
    z-index: 10;
    animation: progressBar 10s linear infinite;
  }

  @keyframes progressBar {
    0% {
      width: 0%;
    }
    100% {
      width: 100%;
    }
  }

  .state-indicators {
    position: absolute;
    bottom: 30px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 15px;
    z-index: 10;
    background: rgba(0, 0, 0, 0.2);
    padding: 10px 20px;
    border-radius: 25px;
    backdrop-filter: blur(10px);
  }

  .state-dot {
    width: 12px;
    height: 12px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.4);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    border: 2px solid transparent;
    cursor: pointer;
    position: relative;
  }

  .state-dot:hover {
    transform: scale(1.1);
    background: rgba(255, 255, 255, 0.7);
  }

  .state-dot:focus-visible {
    outline: 2px solid white;
    outline-offset: 4px;
  }

  .state-dot.active {
    background: white;
    box-shadow: 0 0 20px rgba(255, 255, 255, 0.8);
    transform: scale(1.3);
  }

  .state-dot.active::before {
    content: "";
    position: absolute;
    top: -5px;
    left: -5px;
    right: -5px;
    bottom: -5px;
    border-radius: 50%;
    background: rgba(255, 255, 255, 0.2);
    animation: pulse 2s infinite;
  }

  @keyframes pulse {
    0% {
      transform: scale(0.8);
      opacity: 1;
    }
    100% {
      transform: scale(1.4);
      opacity: 0;
    }
  }

  .big {
    width: 120px;
    height: 35px;
    background: linear-gradient(45deg, rgba(0, 0, 0, 0.3), rgba(0, 0, 0, 0.5));
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 40px;
    border-radius: 25px;
    backdrop-filter: blur(10px);
    border: 1px solid rgba(255, 255, 255, 0.2);
    position: relative;
    overflow: hidden;
  }

  .big::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.3),
      transparent
    );
    animation: shimmer 2s infinite;
  }

  @keyframes shimmer {
    0% {
      left: -100%;
    }
    100% {
      left: 100%;
    }
  }

  .big span {
    font-size: 14px;
    color: white;
    font-weight: bold;
    letter-spacing: 1px;
  }

  .navigation-arrows {
    width: 50px;
    height: 50px;
    cursor: pointer;
    border-radius: 50%;
    background: rgba(0, 0, 0, 0.3);
    color: white;
    font-size: 32px;
    font-weight: bold;
    border: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: absolute;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    backdrop-filter: blur(10px);
    z-index: 15;
    top: 50%;
    transform: translateY(-50%);
  }

  .navigation-arrows:hover {
    background: rgba(0, 0, 0, 0.5);
    transform: translateY(-50%) scale(1.1);
  }

  .navigation-arrows:focus-visible {
    outline: 2px solid white;
    outline-offset: 4px;
  }

  .prev-arrow {
    left: 20px;
  }

  .next-arrow {
    right: 20px;
  }

  .ai {
    color: white;
    font-size: 32px;
    font-weight: 900;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
    margin: 5px 0;
  }

  h3,
  p {
    color: rgba(255, 255, 255, 0.9);
    font-size: 14px;
    font-weight: 500;
    letter-spacing: 0.5px;
    margin: 10px 0;
  }

  .from {
    display: flex;
    gap: 15px;
    height: 60px;
    align-items: center;
    margin: 15px 0;
  }

  .from h3 {
    margin: 0;
    font-size: 12px;
    opacity: 0.8;
  }

  .left {
    overflow: hidden;
    position: relative;
    padding: 0 40px;
    display: flex;
    align-items: center;
    z-index: 5;
  }

  .hero-content {
    position: absolute;
    top: 50%;
    left: 40px;
    width: calc(100% - 80px);
    opacity: 0;
    transform: translateY(-50%) translateX(-100px) rotateY(-15deg);
    filter: blur(10px);
    transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
    z-index: 1;
    pointer-events: none;
  }

  .hero-content.active {
    opacity: 1;
    transform: translateY(-50%) translateX(0) rotateY(0deg);
    filter: blur(0px);
    z-index: 10;
    pointer-events: auto;
  }

  .hero-content.exit {
    opacity: 0;
    transform: translateY(-50%) translateX(100px) rotateY(15deg);
    filter: blur(10px);
    z-index: 1;
    pointer-events: none;
  }

  .hero-content a {
    display: inline-block;
    width: 170px;
    height: 40px;
    cursor: pointer;
    border-radius: 15px;
    background: linear-gradient(
      45deg,
      rgba(255, 255, 255, 0.9),
      rgba(255, 255, 255, 0.7)
    );
    color: #333;
    font-size: 18px;
    font-weight: bold;
    margin-top: 20px;
    border: none;
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
    overflow: hidden;
    box-shadow: 0 8px 25px rgba(0, 0, 0, 0.2);
    text-decoration: none;
    text-align: center;
    line-height: 40px;
    z-index: 20;
  }

  .hero-content a::before {
    content: "";
    position: absolute;
    top: 0;
    left: -100%;
    width: 100%;
    height: 100%;
    background: linear-gradient(
      90deg,
      transparent,
      rgba(255, 255, 255, 0.5),
      transparent
    );
    transition: left 0.5s;
  }

  .hero-content a:hover {
    transform: translateY(-3px) scale(1.05);
    box-shadow: 0 15px 35px rgba(0, 0, 0, 0.3);
  }

  .hero-content a:hover::before {
    left: 100%;
  }

  .hero-content a:active {
    transform: translateY(-1px) scale(1.02);
  }

  .hero-content a:focus-visible {
    outline: 3px solid white;
    outline-offset: 4px;
  }

  .img-container {
    width: 350px;
    height: 320px;
    margin: auto;
    margin-top: 100px;
    overflow: visible;
    perspective: 1000px;
    position: relative;
    transition: all 1s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .card-content.slide-1 .img-container {
    width: 320px;
    height: 280px;
  }

  .card-content.slide-2 .img-container {
    width: 300px;
    height: 340px;
  }

  .card-content.slide-3 .img-container {
    width: 280px;
    height: 300px;
  }

  .img-container img {
    width: 100%;
    height: 100%;
    object-fit: contain;
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0;
    transform: translateZ(-300px) rotateX(45deg) scale(0.8);
    transition: all 1.2s cubic-bezier(0.4, 0, 0.2, 1);
    border-radius: 15px;
    box-shadow: 0 25px 50px rgba(0, 0, 0, 0.3);
    filter: drop-shadow(0 10px 20px rgba(0, 0, 0, 0.2));
  }

  .img-container img.active {
    opacity: 1;
    transform: translateZ(0) rotateX(0deg) scale(1);
    animation: phoneFloat 4s ease-in-out infinite;
  }

  @keyframes phoneFloat {
    0%,
    100% {
      transform: translateZ(0) rotateX(0deg) scale(1) translateY(0px);
    }
    50% {
      transform: translateZ(0) rotateX(0deg) scale(1) translateY(-10px);
    }
  }

  .img-container img.exit {
    opacity: 0;
    transform: translateZ(-300px) rotateX(-45deg) scale(0.8);
  }

  .img-container #img2.active {
    animation:
      phoneFloat 4s ease-in-out infinite,
      phoneRotate 8s linear infinite;
  }

  @keyframes phoneRotate {
    0% {
      transform: translateZ(0) rotateY(0deg) scale(1) translateY(0px);
    }
    25% {
      transform: translateZ(0) rotateY(5deg) scale(1) translateY(-5px);
    }
    50% {
      transform: translateZ(0) rotateY(0deg) scale(1) translateY(-10px);
    }
    75% {
      transform: translateZ(0) rotateY(-5deg) scale(1) translateY(-5px);
    }
    100% {
      transform: translateZ(0) rotateY(0deg) scale(1) translateY(0px);
    }
  }

  .img-container #img2.exit {
    transform: translateX(-400px) translateZ(-200px) rotateY(-45deg) scale(0.8);
  }

  .seesaw {
    display: inline-block;
    transform-origin: 50% 50%;
    animation: seesaw var(--speed) ease-in-out infinite;
    will-change: transform;
    margin-top: -4px;
    color: white;
    font-size: 24px;
    font-weight: bold;
    text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
  }

  @keyframes seesaw {
    0% {
      transform: rotate(-var(--tilt)) scale(1);
    }
    50% {
      transform: rotate(var(--tilt)) scale(1.1);
    }
    100% {
      transform: rotate(-var(--tilt)) scale(1);
    }
  }

  .right {
    position: relative;
    overflow: hidden;
  }

  @media screen and (min-width: 0px) and (max-width: 400px) {
    .card-content {
      grid-template-columns: 1fr;
      height: 100%;
    }

    .card-container {
      height: 800px !important;
      margin-top: 20px !important;
    }

    .left {
      height: 450px;
    }

    .right {
      height: 100%;
    }

    .big {
      margin-top: 70px;
    }

    .card-container {
      margin: 0 auto;
      margin-top: -50px;
      width: 87%;
      border-radius: 10px !important;
    }

    .card-container {
      height: 100vh;
      border-radius: 0;
    }

    .left {
      padding: 20px;
    }

    .ai {
      text-align: center;
      font-size: 28px;
    }

    .from {
      justify-content: center;
      width: 100%;
    }

    .hero-content a {
      margin: 20px auto;
      display: block;
    }

    h3,
    p {
      text-align: center;
    }

    .img-container {
      margin-top: 10px;
    }

    .navigation-arrows {
      display: none;
    }
  }

  @media screen and (min-width: 401px) and (max-width: 768px) {
    .card-content {
      grid-template-columns: 1fr;
      height: 100%;
    }

    .left {
      height: 450px;
    }

    .big {
      margin-top: 70px;
    }

    .card-container {
      margin: 0 auto;
      margin-top: 20px;
      width: 87%;
      border-radius: 10px !important;
      margin-top: 20px !important;
    }

    .card-container {
      height: 100vh;
      border-radius: 0;
    }

    .left {
      padding: 20px;
    }

    .ai {
      text-align: center;
      font-size: 28px;
    }

    .from {
      justify-content: center;
      width: 100%;
    }

    .hero-content a {
      margin: 20px auto;
      display: block;
    }

    h3,
    p {
      text-align: center;
    }

    .img-container {
      margin-top: 10px;
    }

    .navigation-arrows {
      display: none;
    }
  }
</style>

<script>
  class ShoppingCarousel {
    private currentIndex: number = 0;
    private totalSlides: number = 3;
    private slideInterval: number = 10000;
    private autoSlideTimer: number | null = null;

    constructor() {
      this.init();
    }

    private init(): void {
      this.bindEvents();
      this.showSlide(this.currentIndex);
      this.updateStateIndicators(this.currentIndex);
      this.updateProgressBar();
      this.startAutoSlide();
    }

    private bindEvents(): void {
      const prevBtn = document.getElementById(
        "prevBtn"
      ) as HTMLButtonElement | null;
      const nextBtn = document.getElementById(
        "nextBtn"
      ) as HTMLButtonElement | null;

      if (prevBtn)
        prevBtn.addEventListener("click", () => this.previousSlide());
      if (nextBtn) nextBtn.addEventListener("click", () => this.nextSlide());

      document.querySelectorAll(".state-dot").forEach((dot, index) => {
        dot.addEventListener("click", () => this.goToSlide(index));
        dot.addEventListener("keydown", (e: Event) => {
          const keyEvent = e as KeyboardEvent;
          if (keyEvent.key === "Enter" || keyEvent.key === " ") {
            e.preventDefault();
            this.goToSlide(index);
          }
        });
      });

      const container = document.querySelector(
        ".card-container"
      ) as HTMLElement | null;
      if (container) {
        container.addEventListener("mouseenter", () => this.pauseAutoSlide());
        container.addEventListener("mouseleave", () => this.startAutoSlide());
      }

      document.addEventListener("keydown", (e: KeyboardEvent) => {
        if (e.key === "ArrowLeft") this.previousSlide();
        if (e.key === "ArrowRight") this.nextSlide();
      });

      this.setupTouchEvents();
    }

    private setupTouchEvents(): void {
      let startX = 0;
      let endX = 0;
      const container = document.querySelector(
        ".card-container"
      ) as HTMLElement | null;

      if (container) {
        container.addEventListener("touchstart", (e: TouchEvent) => {
          startX = e.touches[0].clientX;
        });

        container.addEventListener("touchend", (e: TouchEvent) => {
          endX = e.changedTouches[0].clientX;
          this.handleSwipe(startX, endX);
        });
      }
    }

    private handleSwipe(startX: number, endX: number): void {
      const swipeThreshold = 50;
      const diff = startX - endX;

      if (Math.abs(diff) > swipeThreshold) {
        if (diff > 0) {
          this.nextSlide();
        } else {
          this.previousSlide();
        }
      }
    }

    private updateStateIndicators(index: number): void {
      document.querySelectorAll(".state-dot").forEach((dot, i) => {
        dot.classList.toggle("active", i === index);
        dot.setAttribute("aria-current", i === index ? "true" : "false");
      });
    }

    private updateProgressBar(): void {
      const progressBar = document.querySelector(
        ".progress-bar"
      ) as HTMLElement | null;
      if (progressBar) {
        progressBar.style.animation = "none";
        progressBar.offsetHeight;
        progressBar.style.animation = "progressBar 10s linear forwards";
        progressBar.setAttribute("aria-valuenow", "0");
      }
    }

    private showSlide(index: number): void {
      document.querySelectorAll(".hero-content").forEach((hero, i) => {
        hero.classList.remove("active", "exit");
        hero.setAttribute("aria-hidden", i !== index ? "true" : "false");
      });
      document.querySelectorAll(".img-container img").forEach((img) => {
        img.classList.remove("active", "exit");
      });

      const heroElement = document.getElementById(
        `hero${index + 1}`
      ) as HTMLElement | null;
      const imgElement = document.getElementById(
        `img${index + 1}`
      ) as HTMLImageElement | null;

      if (heroElement) {
        heroElement.classList.add("active");
        heroElement.setAttribute("aria-hidden", "false");
      }
      if (imgElement) imgElement.classList.add("active");
    }

    private hideSlide(index: number): void {
      const heroElement = document.getElementById(
        `hero${index + 1}`
      ) as HTMLElement | null;
      const imgElement = document.getElementById(
        `img${index + 1}`
      ) as HTMLImageElement | null;

      if (heroElement) {
        heroElement.classList.add("exit");
        heroElement.setAttribute("aria-hidden", "true");
      }
      if (imgElement) imgElement.classList.add("exit");
    }

    private goToSlide(index: number): void {
      if (index === this.currentIndex) return;

      this.pauseAutoSlide();
      this.hideSlide(this.currentIndex);

      const cardContent = document.querySelector(
        ".card-content"
      ) as HTMLElement | null;
      if (cardContent) {
        cardContent.classList.remove("slide-1", "slide-2", "slide-3");
        cardContent.classList.add(`slide-${index + 1}`);
      }

      this.updateStateIndicators(index);
      this.updateProgressBar();

      setTimeout(() => {
        this.currentIndex = index;
        this.showSlide(this.currentIndex);
      }, 500);

      this.startAutoSlide();
    }

    private nextSlide(): void {
      const nextIndex = (this.currentIndex + 1) % this.totalSlides;
      this.goToSlide(nextIndex);
    }

    private previousSlide(): void {
      const prevIndex =
        (this.currentIndex - 1 + this.totalSlides) % this.totalSlides;
      this.goToSlide(prevIndex);
    }

    private startAutoSlide(): void {
      this.pauseAutoSlide();
      this.autoSlideTimer = window.setInterval(
        () => this.nextSlide(),
        this.slideInterval
      );
    }

    private pauseAutoSlide(): void {
      if (this.autoSlideTimer) {
        clearInterval(this.autoSlideTimer);
        this.autoSlideTimer = null;
      }
    }
  }

  document.addEventListener("DOMContentLoaded", () => {
    new ShoppingCarousel();
  });
</script>

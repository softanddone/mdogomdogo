---
// ProductGrid.astro
interface Product {
  id: string;
  name: string;
  storage: string;
  images: string[];
  deposit: number;
  dailyPayment: number;
  paymentDays: number;
  whatsappNumber: string;
  description: string;
  features: string[];
}

interface Props {
  products: Product[];
}

const { products } = Astro.props;

// Default products if none provided
const defaultProducts: Product[] = [
  {
    id: "1",
    name: "Camon 40 Pro Max",
    storage: "256GB",
    images: [
      "/phones/camon1.jpeg",
      "/phones/camon2.jpeg",
      "/phones/camon3.jpeg",
      "/phones/camon4.jpg",
    ],
    deposit: 7200,
    dailyPayment: 180,
    paymentDays: 90,
    whatsappNumber: "+254720202167",
    description:
      "Fresh in the box — includes cover, fast charger, and all accessories",
    features: [
      "Waterproof design",
      "Curved screen display",
      "Storage: 256GB ROM / 8GB RAM",
      "Camera: 50MP front & back, ultra-wide, crystal-clear quality",
      "Warranty: 2 years",
      "Brand new (not refurbished or used)",
    ],
  },
  {
    id: "2",
    name: "Tecno Spark 40",
    storage: "128GB",
    images: [
      "/phones/spark1.jpeg",
      "/phones/spark2.jpeg",
      "/phones/spark3.jpeg",
    ],
    deposit: 2900,
    dailyPayment: 85,
    paymentDays: 90,
    whatsappNumber: "+254720202167",
    description:
      "Brand new — comes with protective case, original charger, and earphones",
    features: [
      "Water-resistant design",
      "Dynamic AMOLED display",
      "Storage: 128GB ROM / 4+4 GB RAM",
      "Camera: 50MP",
      "Warranty: 2 years",
      "Brand new (not refurbished or used)",
      "Complete accessories package included",
    ],
  },
  {
    id: "3",
    name: "Infinix Hot60i",
    storage: "128GB",
    images: [
      "/phones/infinix1.jpeg",
      "/phones/infinix2.jpg",
      "/phones/infinix3.jpg",
      "/phones/infinix4.jpg",
    ],
    deposit: 2900,
    dailyPayment: 82,
    paymentDays: 90,
    whatsappNumber: "+254720202167",
    description:
      "Brand new — comes with protective case, original charger, and earphones",
    features: [
      "Water and dust resistant (IP68)",
      "Super Retina XDR display",
      "Storage: 128GB ROM / 6GB RAM",
      "Camera: 50MP main, 12MP ultra-wide, advanced dual camera system",
      "Warranty: 2 years",
      "Brand new sealed",
      "Premium accessories included",
    ],
  },
];

const productList = products || defaultProducts;
---

<div class="products-wrapper">
  <div class="products-grid">
    {
      productList.map((product) => (
        <div class="product-card" data-product-id={product.id}>
          {/* Product Name - Now at the top */}
          <div class="product-header">
            <h2 class="product-name">{product.name}</h2>
            <p class="payment">Payment after delivery</p>
          </div>

          {/* Image Section */}
          <div class="image-section">
            <div class="image-container">
              {product.images.map((image, idx) => (
                <img
                  src={image}
                  alt={`${product.name} - Image ${idx + 1}`}
                  class={`product-image ${idx === 0 ? "active" : ""}`}
                  data-index={idx}
                />
              ))}
            </div>

            {/* Navigation Buttons */}
            <button class="nav-btn prev-btn" aria-label="Previous image">
              <svg
                class="icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M15 19l-7-7 7-7"
                />
              </svg>
            </button>

            <button class="nav-btn next-btn" aria-label="Next image">
              <svg
                class="icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M9 5l7 7-7 7"
                />
              </svg>
            </button>

            {/* Image Indicators */}
            <div class="indicators">
              {product.images.map((_, idx) => (
                <button
                  class={`indicator ${idx === 0 ? "active" : ""}`}
                  data-index={idx}
                  aria-label={`Go to image ${idx + 1}`}
                />
              ))}
            </div>

            {/* Badge */}
            <div class="badge">Lipa Mdogo Mdogo</div>
          </div>

          {/* Content Section */}
          <div class="content-section">
            {/* Always Visible Pricing */}
            <div class="pricing-summary">
              <div class="price-item">
                <span class="price-label">Deposit</span>
                <span class="price-value">
                  KES {product.deposit.toLocaleString()}
                </span>
              </div>
              <div class="price-divider" />
              <div class="price-item">
                <span class="price-label">Daily</span>
                <span class="price-value">KES {product.dailyPayment}</span>
              </div>
            </div>

            {/* Show More Button */}
            <button class="show-more-btn">
              <span class="show-more-text">Show More Details</span>
              <svg
                class="chevron-icon"
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </button>

            {/* Hidden Details */}
            <div class="hidden-details">
              {/* Key Features */}
              <div class="features-section">
                <h3 class="features-title">Key Features</h3>
                <ul class="features-list">
                  {product.features.map((feature) => (
                    <li class="feature-item">
                      <svg
                        class="feature-icon"
                        fill="currentColor"
                        viewBox="0 0 20 20"
                      >
                        <path
                          fill-rule="evenodd"
                          d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                          clip-rule="evenodd"
                        />
                      </svg>
                      <span>{feature}</span>
                    </li>
                  ))}
                </ul>
              </div>

              {/* Product Description */}
              <div class="product-description">
                <svg
                  class="description-icon"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z"
                    clip-rule="evenodd"
                  />
                </svg>
                <p class="description-text">{product.description}</p>
              </div>

              {/* Full Pricing Card */}
              <div class="pricing-card">
                <div class="price-row">
                  <span class="price-label">Deposit</span>
                  <span class="price-value deposit">
                    KES {product.deposit.toLocaleString()}
                  </span>
                </div>

                <div class="divider" />

                <div class="price-row">
                  <span class="price-label">Daily Payment</span>
                  <div class="daily-payment">
                    <div class="daily-amount">KES {product.dailyPayment}</div>
                    {/* <div class="daily-duration">
                      for {product.paymentDays} days
                    </div> */}
                  </div>
                </div>
              </div>

              {/* Service Area Notice */}
              <div class="service-area">
                <svg
                  class="location-icon"
                  fill="currentColor"
                  viewBox="0 0 20 20"
                >
                  <path
                    fill-rule="evenodd"
                    d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z"
                    clip-rule="evenodd"
                  />
                </svg>
                <div>
                  <p class="service-title">Service Areas</p>
                  <p class="service-text">
                    We only serve Nairobi, Kiambu and surrounding areas
                  </p>
                </div>
              </div>

              {/* WhatsApp Button */}
              <a
                href={`https://wa.me/${product.whatsappNumber}?text=${encodeURIComponent(`Hi, I'm interested in ordering the ${product.name} (${product.storage}) with:\nDeposit: KES ${product.deposit.toLocaleString()}\nDaily Payment: KES ${product.dailyPayment}`)}`}
                target="_blank"
                rel="noopener noreferrer"
                class="whatsapp-btn"
              >
                <svg viewBox="0 0 24 24" class="whatsapp-icon">
                  <path
                    fill="currentColor"
                    d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z"
                  />
                </svg>
                <span>Order via WhatsApp</span>
              </a>

              {/* Trust Indicators */}
              <div class="trust-indicators">
                <div class="trust-item">
                  <svg
                    class="trust-icon"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path
                      fill-rule="evenodd"
                      d="M2.166 4.999A11.954 11.954 0 0010 1.944 11.954 11.954 0 0017.834 5c.11.65.166 1.32.166 2.001 0 5.225-3.34 9.67-8 11.317C5.34 16.67 2 12.225 2 7c0-.682.057-1.35.166-2.001zm11.541 3.708a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z"
                      clip-rule="evenodd"
                    />
                  </svg>
                  <span>Payment After Delivery</span>
                </div>
                <div class="dot" />
                <div class="trust-item">
                  <svg
                    class="trust-icon"
                    fill="currentColor"
                    viewBox="0 0 20 20"
                  >
                    <path d="M8 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0zM15 16.5a1.5 1.5 0 11-3 0 1.5 1.5 0 013 0z" />
                    <path d="M3 4a1 1 0 00-1 1v10a1 1 0 001 1h1.05a2.5 2.5 0 014.9 0H10a1 1 0 001-1V5a1 1 0 00-1-1H3zM14 7a1 1 0 00-1 1v6.05A2.5 2.5 0 0115.95 16H17a1 1 0 001-1v-5a1 1 0 00-.293-.707l-2-2A1 1 0 0015 7h-1z" />
                  </svg>
                  <span>Fast Delivery</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      ))
    }
  </div>
</div>

<style>
  .products-wrapper {
    min-height: 100vh;
    background: linear-gradient(
      135deg,
      rgb(248, 250, 252) 0%,
      rgb(239, 246, 255) 50%,
      rgb(238, 242, 255) 100%
    );
    padding: 2rem 1rem;
  }

  .products-grid {
    max-width: 1400px;
    margin: 0 auto;
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
    gap: 2rem;
  }

  @media (max-width: 640px) {
    .products-grid {
      grid-template-columns: 1fr;
    }
  }

  .product-card {
    background: white;
    border-radius: 1.5rem;
    box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
    overflow: hidden;
    transition: all 0.3s ease;
  }

  .product-card:hover {
    box-shadow: 0 30px 60px -15px rgba(0, 0, 0, 0.3);
    transform: translateY(-4px);
  }

  /* Product Header - Now at top */
  .product-header {
    padding: 1.5rem 1.5rem 1rem 1.5rem;
    background: white;
  }

  .product-name {
    font-size: 1.5rem;
    font-weight: 700;
    color: rgb(15, 23, 42);
    margin: 0 0 0.25rem 0;
  }

  .product-storage {
    font-size: 0.875rem;
    color: rgb(100, 116, 139);
    margin: 0;
  }

  /* Image Section */
  .image-section {
    position: relative;
    background: linear-gradient(135deg, rgb(241, 245, 249), rgb(226, 232, 240));
    aspect-ratio: 1;
  }

  .image-container {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }

  .product-image {
    width: 100%;
    height: 100%;
    object-fit: cover;
    position: absolute;
    top: 0;
    left: 0;
    opacity: 0;
    transform: scale(1.1);
    transition:
      opacity 0.6s ease,
      transform 0.6s ease;
  }

  .product-image.active {
    opacity: 1;
    transform: scale(1);
  }

  .nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background: rgba(255, 255, 255, 0.9);
    backdrop-filter: blur(8px);
    padding: 0.5rem;
    border-radius: 9999px;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
    z-index: 10;
  }

  .nav-btn:hover {
    background: white;
  }

  .prev-btn {
    left: 0.75rem;
  }

  .next-btn {
    right: 0.75rem;
  }

  .nav-btn .icon {
    width: 1.25rem;
    height: 1.25rem;
    color: rgb(51, 65, 85);
  }

  .indicators {
    position: absolute;
    bottom: 1rem;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 0.5rem;
    z-index: 10;
  }

  .indicator {
    height: 0.375rem;
    width: 0.375rem;
    border-radius: 9999px;
    background: rgba(255, 255, 255, 0.5);
    border: none;
    cursor: pointer;
    transition: all 0.3s ease;
    padding: 0;
  }

  .indicator.active {
    width: 2rem;
    background: white;
  }

  .indicator:hover {
    background: rgba(255, 255, 255, 0.75);
  }

  .badge {
    position: absolute;
    top: 1rem;
    left: 1rem;
    background: linear-gradient(135deg, rgb(16, 185, 129), rgb(20, 184, 166));
    color: white;
    padding: 0.375rem 1rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 600;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
  }

  /* Content Section */
  .content-section {
    padding: 1.5rem;
    display: flex;
    flex-direction: column;
    gap: 1rem;
  }

  /* Pricing Summary - Always Visible */
  .pricing-summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    background: linear-gradient(135deg, rgb(248, 250, 252), rgb(239, 246, 255));
    border-radius: 1rem;
    padding: 1rem 1.25rem;
    border: 1px solid rgb(226, 232, 240);
  }

  .price-item {
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }

  .price-label {
    font-size: 0.75rem;
    color: rgb(100, 116, 139);
    font-weight: 500;
  }

  .price-value {
    font-size: 1.25rem;
    font-weight: 700;
    color: rgb(15, 23, 42);
  }

  .price-divider {
    width: 1px;
    height: 2.5rem;
    background: rgb(226, 232, 240);
  }

  /* Show More Button */
  .show-more-btn {
    width: 100%;
    background: white;
    border: 2px solid rgb(226, 232, 240);
    color: rgb(71, 85, 105);
    font-weight: 600;
    padding: 0.875rem 1.5rem;
    border-radius: 1rem;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.5rem;
    font-size: 0.875rem;
  }

  .show-more-btn:hover {
    background: rgb(248, 250, 252);
    border-color: rgb(203, 213, 225);
  }

  .chevron-icon {
    width: 1.25rem;
    height: 1.25rem;
    transition: transform 0.3s ease;
  }

  .show-more-btn.expanded .chevron-icon {
    transform: rotate(180deg);
  }

  .show-more-btn.expanded .show-more-text::before {
    content: "Show Less";
  }

  .show-more-text::before {
    content: "Show More Details";
  }

  /* Hidden Details */
  .hidden-details {
    display: none;
    flex-direction: column;
    gap: 1.25rem;
    animation: slideDown 0.3s ease;
  }

  .hidden-details.visible {
    display: flex;
  }

  @keyframes slideDown {
    from {
      opacity: 0;
      transform: translateY(-10px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  .pricing-card {
    background: linear-gradient(135deg, rgb(248, 250, 252), rgb(239, 246, 255));
    border-radius: 1rem;
    padding: 1.25rem;
    border: 1px solid rgb(226, 232, 240);
  }

  .price-row {
    display: flex;
    justify-content: space-between;
    align-items: center;
  }

  .price-value.deposit {
    font-size: 1.5rem;
    font-weight: 700;
    color: rgb(15, 23, 42);
  }

  .divider {
    height: 1px;
    background: rgb(226, 232, 240);
    margin: 0.75rem 0;
  }

  .daily-payment {
    text-align: right;
  }

  .daily-amount {
    font-size: 1.25rem;
    font-weight: 700;
    color: rgb(16, 185, 129);
  }

  .daily-duration {
    font-size: 0.75rem;
    color: rgb(100, 116, 139);
  }

  .service-area {
    background: rgb(239, 246, 255);
    border: 1px solid rgb(191, 219, 254);
    border-radius: 0.75rem;
    padding: 1rem;
    display: flex;
    gap: 0.75rem;
  }

  .location-icon {
    width: 1.25rem;
    height: 1.25rem;
    color: rgb(37, 99, 235);
    flex-shrink: 0;
    margin-top: 0.125rem;
  }

  .service-title {
    font-size: 0.875rem;
    font-weight: 600;
    color: rgb(30, 58, 138);
    margin: 0 0 0.25rem 0;
  }

  .service-text {
    font-size: 0.75rem;
    color: rgb(29, 78, 216);
    margin: 0;
  }

  /* Product Description */
  .product-description {
    background: rgb(254, 252, 232);
    border: 1px solid rgb(253, 230, 138);
    border-radius: 0.75rem;
    padding: 1rem;
    display: flex;
    gap: 0.75rem;
    align-items: start;
  }

  .description-icon {
    width: 1.25rem;
    height: 1.25rem;
    color: rgb(217, 119, 6);
    flex-shrink: 0;
    margin-top: 0.125rem;
  }

  .description-text {
    font-size: 0.875rem;
    color: rgb(120, 53, 15);
    line-height: 1.5;
    margin: 0;
  }

  /* Key Features */
  .features-section {
    background: white;
    border: 1px solid rgb(226, 232, 240);
    border-radius: 1rem;
    padding: 1.25rem;
  }

  .features-title {
    font-size: 1rem;
    font-weight: 700;
    color: rgb(15, 23, 42);
    margin: 0 0 1rem 0;
  }

  .features-list {
    list-style: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 0.75rem;
  }

  .feature-item {
    display: flex;
    align-items: start;
    gap: 0.625rem;
    font-size: 0.875rem;
    color: rgb(51, 65, 85);
    line-height: 1.5;
  }

  .feature-icon {
    width: 1.25rem;
    height: 1.25rem;
    color: rgb(16, 185, 129);
    flex-shrink: 0;
    margin-top: 0.125rem;
  }

  .whatsapp-btn {
    width: 100%;
    background: linear-gradient(135deg, rgb(34, 197, 94), rgb(16, 185, 129));
    color: white;
    font-weight: 700;
    padding: 1rem 1.5rem;
    border-radius: 1rem;
    box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);
    border: none;
    cursor: pointer;
    transition: all 0.2s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 0.75rem;
    text-decoration: none;
    font-size: 1.125rem;
  }

  .whatsapp-btn:hover {
    background: linear-gradient(135deg, rgb(22, 163, 74), rgb(5, 150, 105));
    box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1);
    transform: scale(1.02);
  }

  .whatsapp-btn:active {
    transform: scale(0.98);
  }

  .whatsapp-icon {
    width: 1.5rem;
    height: 1.5rem;
  }

  .trust-indicators {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 1rem;
    font-size: 0.75rem;
    color: rgb(100, 116, 139);
    padding-top: 0.5rem;
  }

  .trust-item {
    display: flex;
    align-items: center;
    gap: 0.25rem;
  }

  .trust-icon {
    width: 1rem;
    height: 1rem;
    color: rgb(16, 185, 129);
  }

  .dot {
    width: 0.25rem;
    height: 0.25rem;
    border-radius: 9999px;
    background: rgb(203, 213, 225);
  }
</style>

<script>
  // Image carousel functionality for all product cards
  document.querySelectorAll(".product-card").forEach((card) => {
    const images = card.querySelectorAll(".product-image");
    const indicators = card.querySelectorAll(".indicator");
    const prevBtn = card.querySelector(".prev-btn");
    const nextBtn = card.querySelector(".next-btn");
    const totalImages = images.length;
    let currentIndex = 0;
    let autoPlayInterval: number;

    function showImage(index: number) {
      images.forEach((img, i) => {
        img.classList.toggle("active", i === index);
      });
      indicators.forEach((ind, i) => {
        ind.classList.toggle("active", i === index);
      });
      currentIndex = index;
    }

    function nextImage() {
      const nextIndex = (currentIndex + 1) % totalImages;
      showImage(nextIndex);
    }

    function prevImage() {
      const prevIndex = (currentIndex - 1 + totalImages) % totalImages;
      showImage(prevIndex);
    }

    // Auto-play carousel every 3 seconds
    function startAutoPlay() {
      autoPlayInterval = window.setInterval(() => {
        nextImage();
      }, 3000);
    }

    function stopAutoPlay() {
      clearInterval(autoPlayInterval);
    }

    // Start auto-play
    startAutoPlay();

    // Pause auto-play on hover
    card.addEventListener("mouseenter", stopAutoPlay);
    card.addEventListener("mouseleave", startAutoPlay);

    // Next button
    nextBtn?.addEventListener("click", () => {
      stopAutoPlay();
      nextImage();
      startAutoPlay();
    });

    // Previous button
    prevBtn?.addEventListener("click", () => {
      stopAutoPlay();
      prevImage();
      startAutoPlay();
    });

    // Indicator buttons
    indicators.forEach((indicator, index) => {
      indicator.addEventListener("click", () => {
        stopAutoPlay();
        showImage(index);
        startAutoPlay();
      });
    });

    // Show More / Show Less functionality
    const showMoreBtn = card.querySelector(".show-more-btn");
    const hiddenDetails = card.querySelector(".hidden-details");

    showMoreBtn?.addEventListener("click", () => {
      const isExpanded = hiddenDetails?.classList.contains("visible");

      if (isExpanded) {
        hiddenDetails?.classList.remove("visible");
        showMoreBtn.classList.remove("expanded");
      } else {
        hiddenDetails?.classList.add("visible");
        showMoreBtn.classList.add("expanded");
      }
    });
  });
</script>

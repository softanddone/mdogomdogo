---
import Display from "../components/Display.astro";
import Gift from "../components/Gift.astro";
import Nav2 from "../components/Nav2.astro";
import ProductDetails from "../components/ProductDetails.astro";
import { products } from "../data/product2";
import Layout from "../layouts/Layout.astro";
import { generateProductSchema } from "../utils/structureData";

export async function getStaticPaths() {
  return products.map((product) => ({
    params: { slug: product.slug },
  }));
}

const { slug } = Astro.params;
const product = products.find((p) => p.slug === slug);

if (!product) {
  throw new Error("Product not found");
}

const schema = generateProductSchema(product);

const seo = {
  title: `${product.name} - Buy Now | Lipa Pole Pole`,
  description:
    product.description ||
    `Buy ${product.name} at a flexible lipa mdogo mdogo price. Pay small deposit & receive it today.`,
  canonical: `https://mdogomdogodeals.co.ke/${product.slug}`,
  ogImage: `https://mdogomdogodeals.co.ke/${product.source}`,
  schema,
};
---

<Layout {...seo}>
  
  <Gift />
  <Nav2 />
  <Display {...product} />
</Layout>
